<% @classes_for_body = "bg-gradient-to-b from-blue-500 to-pink-500" %>

<div class="max-w-4xl mx-auto mt-16 text-center min-h-screen">
  <!-- Hero -->
  <h1 class="font-header text-6xl font-extrabold bg-gradient-to-b from-blue-400 via-yellow-500 to-black-500 bg-clip-text text-transparent">
    Markus Daisy Social
  </h1>

  <p class="text-lg text-gray-700 mb-6">
    Testataan mit√§ kaikkea t√§ll√§ pystyy tekem√§√§n!
  </p>

  <% if Current.user %>
    <p class="text-gray-600 mb-4">
      Welcome back, <%= Current.user.email_address %>!
    </p>
  <% else %>
    <div class="mt-4 flex items-center justify-center gap-4">
      <%= link_to "Log In", new_session_path, class: "btn btn-primary" %>
      <%= link_to "Sign Up", new_registrations_path, class: "btn btn-secondary" %>
    </div>
  <% end %>

  <!-- Feed -->
  <% if @posts.any? %>
    <div class="mt-12 space-y-6">
      <% @posts.each do |post| %>
        <div class="card bg-base-100 shadow-md p-4">
          <div class="flex justify-between items-center mb-2">
            <strong><%= post.user.email_address %></strong>
          </div>

          <% if post.caption.present? %>
            <p class="text-gray-700 font-semibold"><%= post.caption %></p>
          <% end %>

          <% if post.body.present? %>
            <p class="text-gray-600 mt-1"><%= post.body %></p>
          <% end %>

          <% if post.images.attached? %>
            <div class="grid grid-cols-2 md:grid-cols-3 gap-2 mt-3">
              <% post.images.each do |image| %>
                <%= link_to post_path(post) do %>
                  <%= image_tag image, class: "rounded-lg w-full h-auto cursor-pointer hover:opacity-90" %>
                <% end %>
              <% end %>
            </div>
          <% end %>

          <!-- Likes / Comments -->
          <div class="flex items-center mt-3 space-x-3">
            <% if Current.user && post.likes.exists?(user: Current.user) %>
              <%= button_to "‚ù§Ô∏è Unlike (#{post.likes.count})",
                            post_like_path(post, post.likes.find_by(user: Current.user)),
                            method: :delete,
                            class: "btn btn-error btn-sm" %>
            <% elsif Current.user %>
              <%= button_to "ü§ç Like (#{post.likes.count})",
                            post_likes_path(post),
                            method: :post,
                            class: "btn btn-outline btn-sm" %>
            <% else %>
              <span class="text-gray-500 text-sm">Likes: <%= post.likes.count %></span>
            <% end %>
          </div>

          <% if Current.user %>
            <div class="mt-2">
              <%= form_with(model: [post, Comment.new], local: true) do |f| %>
                <div class="flex gap-2">
                  <%= f.text_area :body, placeholder: "Add a comment...", class: "textarea textarea-bordered w-full" %>
                  <%= f.submit "Comment", class: "btn btn-primary" %>
                </div>
              <% end %>
            </div>
          <% else %>
            <p class="text-gray-500 mt-2 text-sm">Log in to like or comment.</p>
          <% end %>

          <!-- Link to full post page -->
          <div class="mt-2 text-right">
            <%= link_to "View Post", post_path(post), class: "text-blue-600 hover:underline text-sm" %>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <p class="text-gray-500 mt-8">No posts yet. Be the first to share something!</p>
  <% end %>
</div>
