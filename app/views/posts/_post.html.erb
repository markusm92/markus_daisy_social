<div id="<%= dom_id(post) %>" class="card bg-base-100 shadow-md mb-6">
  <!-- Post header -->
  <div class="card-body">
    <h2 class="card-title text-lg font-semibold">
      <%= post.user.email_address %>
    </h2>

    <!-- Post content -->
    <% if post.caption.present? %>
      <p class="text-gray-700"><%= post.caption %></p>
    <% end %>

    <% if post.body.present? %>
      <p class="text-gray-600 mt-2"><%= post.body %></p>
    <% end %>

    <!-- Images -->
    <% if post.images.attached? %>
      <div class="grid grid-cols-2 md:grid-cols-3 gap-3 mt-3">
        <% post.images.each do |image| %>
          <%= image_tag image, class: "rounded-lg shadow-sm w-full h-auto" %>
        <% end %>
      </div>
    <% end %>

    <!-- Likes -->
    <div class="flex items-center mt-4 space-x-3">
      <% if Current.user && post.likes.exists?(user: Current.user) %>
        <%= button_to "â¤ï¸ Unlike (#{post.likes.count})", post_like_path(post, post.likes.find_by(user: Current.user)),
                      method: :delete,
                      class: "btn btn-error btn-sm" %>
      <% else %>
        <%= button_to "ðŸ¤ Like (#{post.likes.count})", post_likes_path(post),
                      method: :post,
                      class: "btn btn-outline btn-sm" %>
      <% end %>
    </div>

    <!-- Comments -->
    <div class="mt-6">
      <h3 class="font-medium text-gray-800 mb-2">Comments</h3>

      <!-- Existing comments -->
      <% if post.comments.any? %>
        <div class="space-y-2">
          <% post.comments.each do |comment| %>
            <div class="bg-gray-100 p-2 rounded-md">
              <strong><%= comment.user.email_address %>:</strong>
              <%= comment.body %>

              <% if comment.user == Current.user %>
                <%= button_to "Delete", post_comment_path(post, comment),
                              method: :delete,
                              class: "btn btn-xs btn-ghost text-red-600 ml-2" %>
              <% end %>
            </div>
          <% end %>
        </div>
      <% else %>
        <p class="text-gray-500 text-sm">No comments yet. Be the first!</p>
      <% end %>

      <!-- New comment form -->
      <% if Current.user %>
        <%= form_with(model: [post, Comment.new], local: true) do |f| %>
          <div class="mt-3">
            <%= f.text_area :body, placeholder: "Write a comment...", class: "textarea textarea-bordered w-full" %>
            <%= f.submit "Comment", class: "btn btn-primary mt-2" %>
          </div>
        <% end %>
      <% else %>
        <p class="text-gray-500 text-sm mt-2">You must be logged in to comment.</p>
      <% end %>
    </div>
  </div>
</div>
